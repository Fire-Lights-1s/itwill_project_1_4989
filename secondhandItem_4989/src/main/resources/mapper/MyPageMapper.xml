<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.itwillbs.mapper.MyPageMapper">
	<select id="getProductList" resultType="com.itwillbs.domain.ProductDTO">
		select * from Product
		where seller_id = #{seller_id}
		<if test="sale == 'pro'">
			and trade_status = '거래 가능' 
		</if>
		<if test="sale == 'com'">
			and trade_status = '거래 완료' 
		</if>
		<if test="sort == 'priceDesc'">
			order by trade_status, product_price desc
		</if>
		<if test="sort == 'priceAsc'">
			order by trade_status, product_price
		</if>
		<if test="sort == 'dateDesc'">
			order by trade_status, created_datetime desc
		</if>
		<if test="sort == 'dateAsc'">
			order by trade_status, created_datetime
		</if>
		<if test="sort == null or sort == ''">
			order by trade_status, created_datetime desc
		</if>
		limit #{startRow},#{pageSize}
	</select>
		
	<select id="getProductCount" resultType="java.lang.Integer">
		select count(*) from Product
		where seller_id = #{seller_id}
		<if test="sale == 'pro'">
			and trade_status = '거래 가능' 
		</if>
		<if test="sale == 'com'">
			and trade_status = '거래 완료' 
		</if>
	</select>
	
	<select id="getZzimList" resultType="com.itwillbs.domain.ProductDTO">
		select * from 
		Zzim z right join Product p
		on z.product_id = p.product_id
		where z.member_id = #{seller_id}
		<if test="sort == 'priceDesc'">
			order by p.product_price desc
		</if>
		<if test="sort == 'priceAsc'">
			order by p.product_price
		</if>
		<if test="sort == 'dateDesc'">
			order by p.created_datetime desc
		</if>
		<if test="sort == 'dateAsc'">
			order by p.created_datetime
		</if>
		<if test="sort == null or sort == ''">
			order by p.created_datetime desc
		</if>
		limit #{startRow},#{pageSize}
	</select>
	
	<select id="getZzimCount" resultType="java.lang.Integer">
		select count(*) from Zzim
		where member_id = #{seller_id}
	</select>
	
	<delete id="deleteZzim">
		delete from Zzim
		where member_id = #{member_id}
		and product_id = #{product_id}
	</delete>
</mapper>

